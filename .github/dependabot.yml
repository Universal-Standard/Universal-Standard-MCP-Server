# ============================================================================
# AUTONOMOUS SELF-HEALING DEPENDABOT CONFIGURATION
# US Department of Special Projects & Unified Response Services (US-SPURS)
# ============================================================================
# 
# AUTONOMOUS FEATURES:
# - AI-powered dependency analysis and validation
# - Automatic testing and deployment
# - Self-healing rollback mechanisms
# - Intelligent conflict resolution
# - Predictive update scheduling
# - Zero-touch security patching
# 
# INTEGRATION POINTS:
# - GitHub Actions for automated workflows
# - OpenAI/Claude for intelligent decision making
# - Automated testing suites
# - Performance monitoring and alerting
# - Rollback and recovery systems
# ============================================================================

version: 2

# Registries for private packages (if needed)
registries:
  npm-github:
    type: npm-registry
    url: https://npm.pkg.github.com
    token: ${{secrets.GITHUB_TOKEN}}

updates:
  # ==========================================================================
  # NPM DEPENDENCIES - AUTONOMOUS MANAGEMENT
  # ==========================================================================
  - package-ecosystem: "npm"
    directory: "/"
    
    # AGGRESSIVE SCHEDULE - Daily checks for maximum security
    schedule:
      interval: "daily"
      time: "03:00"
      timezone: "America/Los_Angeles"
    
    # HIGH PR LIMIT - AI will auto-merge safe updates
    open-pull-requests-limit: 25
    
    # AUTO-ASSIGNEES
    assignees:
      - "UniversalStandards"
    reviewers:
      - "UniversalStandards"
    
    # COMMIT MESSAGE AUTOMATION
    commit-message:
      prefix: "ðŸ¤– deps"
      prefix-development: "ðŸ¤– deps-dev"
      include: "scope"
    
    # COMPREHENSIVE LABELS FOR AI PROCESSING
    labels:
      - "dependencies"
      - "automated"
      - "us-spurs"
      - "ai-managed"
      - "auto-merge-candidate"
    
    # ALWAYS INCREASE VERSIONS
    versioning-strategy: "increase"
    
    # INTELLIGENT GROUPING FOR BATCH PROCESSING
    groups:
      # ======================================================================
      # CRITICAL SECURITY - IMMEDIATE AUTO-MERGE
      # ======================================================================
      critical-security:
        patterns:
          - "helmet"
          - "express-rate-limit"
          - "cors"
          - "express-validator"
          - "bcrypt"
          - "jsonwebtoken"
        update-types:
          - "security"
          - "patch"
          - "minor"
        dependency-type: "production"
      
      # ======================================================================
      # DATABASE STACK - COORDINATED UPDATES
      # ======================================================================
      database-stack:
        patterns:
          - "@neondatabase/*"
          - "drizzle-*"
          - "pg"
          - "@types/pg"
        update-types:
          - "patch"
          - "minor"
        dependency-type: "production"
      
      # ======================================================================
      # EXPRESS FRAMEWORK - SYNCHRONIZED UPDATES
      # ======================================================================
      express-ecosystem:
        patterns:
          - "express"
          - "express-*"
          - "body-parser"
          - "cookie-parser"
          - "compression"
        update-types:
          - "patch"
          - "minor"
        dependency-type: "production"
      
      # ======================================================================
      # AI/ML PROVIDERS - COORDINATED AI STACK
      # ======================================================================
      ai-ml-stack:
        patterns:
          - "openai"
          - "@anthropic-ai/*"
          - "@google-ai/*"
          - "langchain"
          - "@langchain/*"
        update-types:
          - "patch"
          - "minor"
        dependency-type: "production"
      
      # ======================================================================
      # LOGGING & MONITORING - OBSERVABILITY STACK
      # ======================================================================
      observability:
        patterns:
          - "winston"
          - "winston-*"
          - "prom-client"
          - "@opentelemetry/*"
        update-types:
          - "patch"
          - "minor"
      
      # ======================================================================
      # UTILITIES - LOW-RISK UPDATES
      # ======================================================================
      utilities:
        patterns:
          - "uuid"
          - "dotenv"
          - "ws"
          - "axios"
          - "lodash"
          - "moment"
          - "date-fns"
        update-types:
          - "patch"
          - "minor"
      
      # ======================================================================
      # TYPESCRIPT ECOSYSTEM - TYPE SAFETY
      # ======================================================================
      typescript-stack:
        patterns:
          - "@types/*"
          - "typescript"
          - "ts-node"
          - "tsx"
        update-types:
          - "patch"
          - "minor"
      
      # ======================================================================
      # DEVELOPMENT TOOLS - NON-PRODUCTION
      # ======================================================================
      dev-tools:
        patterns:
          - "eslint"
          - "eslint-*"
          - "prettier"
          - "@typescript-eslint/*"
          - "jest"
          - "vitest"
          - "@testing-library/*"
        update-types:
          - "patch"
          - "minor"
        dependency-type: "development"
      
      # ======================================================================
      # BUILD TOOLS - INFRASTRUCTURE
      # ======================================================================
      build-tools:
        patterns:
          - "vite"
          - "webpack"
          - "rollup"
          - "esbuild"
          - "@vitejs/*"
        update-types:
          - "patch"
          - "minor"
        dependency-type: "development"
    
    # MINIMAL IGNORES - LET AI DECIDE
    ignore:
      # Only ignore truly breaking changes that need manual review
      - dependency-name: "node"
        update-types: ["version-update:semver-major"]
    
    # ALLOW ALL UPDATE TYPES
    allow:
      - dependency-type: "direct"
      - dependency-type: "indirect"
      - dependency-type: "production"
      - dependency-type: "development"
    
    # AUTO-REBASE FOR CONTINUOUS INTEGRATION
    rebase-strategy: "auto"
    
    # PULL REQUEST BRANCH PREFIX
    pull-request-branch-name:
      separator: "/"

  # ==========================================================================
  # GITHUB ACTIONS - WORKFLOW AUTOMATION
  # ==========================================================================
  - package-ecosystem: "github-actions"
    directory: "/"
    
    schedule:
      interval: "daily"
      time: "04:00"
      timezone: "America/Los_Angeles"
    
    open-pull-requests-limit: 10
    
    assignees:
      - "UniversalStandards"
    
    commit-message:
      prefix: "ðŸ¤– ci"
      include: "scope"
    
    labels:
      - "github-actions"
      - "ci-cd"
      - "automated"
      - "us-spurs"
      - "ai-managed"
      - "auto-merge-candidate"
    
    groups:
      actions-all:
        patterns:
          - "*"
        update-types:
          - "patch"
          - "minor"
    
    rebase-strategy: "auto"

  # ==========================================================================
  # DOCKER - CONTAINER DEPENDENCIES
  # ==========================================================================
  - package-ecosystem: "docker"
    directory: "/"
    
    schedule:
      interval: "daily"
      time: "05:00"
      timezone: "America/Los_Angeles"
    
    open-pull-requests-limit: 5
    
    assignees:
      - "UniversalStandards"
    
    commit-message:
      prefix: "ðŸ¤– docker"
    
    labels:
      - "docker"
      - "infrastructure"
      - "automated"
      - "us-spurs"
      - "ai-managed"
      - "auto-merge-candidate"
    
    groups:
      docker-base:
        patterns:
          - "node"
          - "alpine"
        update-types:
          - "patch"
          - "minor"
    
    rebase-strategy: "auto"

# ============================================================================
# AUTONOMOUS OPERATION NOTES
# ============================================================================
# 
# This configuration is designed to work with the following workflows:
# 
# 1. auto-merge-ai.yml - AI-powered automatic merging
# 2. dependency-test-suite.yml - Comprehensive testing
# 3. ai-dependency-analyzer.yml - Intelligent analysis
# 4. self-healing-rollback.yml - Automatic recovery
# 5. security-scanner.yml - Continuous security monitoring
# 
# AUTONOMOUS DECISION TREE:
# 
# Security Updates â†’ AI Analysis â†’ Auto-Test â†’ Auto-Merge â†’ Monitor
#                                      â†“ FAIL
#                                   Rollback â†’ Alert â†’ Manual Review
# 
# Patch Updates â†’ AI Risk Score â†’ Auto-Test â†’ Auto-Merge (if score > 85)
#                                      â†“ FAIL
#                                   Rollback â†’ Lower Score â†’ Queue Review
# 
# Minor Updates â†’ AI Compatibility Check â†’ Auto-Test â†’ Auto-Merge (if compatible)
#                                              â†“ FAIL
#                                         Rollback â†’ Analysis â†’ Queue Review
# 
# Major Updates â†’ AI Impact Analysis â†’ Create PR â†’ Require Manual Review
#                                          â†“
#                                    Detailed Report â†’ Recommendations
# 
# ============================================================================
